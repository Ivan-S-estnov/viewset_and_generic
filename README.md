#generic_project

(Работа над SPA веб-приложением и создание бэкенд-сервера, который возвращает клиенту JSON-структуры.)

##Описание проекта:
LMS-система позволяет создавать и управлять курсами, добавлять материалы, а также предоставляет функционал для управления пользователями и их доступами.

##Тестирование:
Протестированы CRUD для Lesson и управления подпиской

##Запуск проекта локально:

1.Устанавливаем зависимости проекта: pip install 

2.Приминяем миграции к базе данных: python manage.py migrate

##Использование:

Запуска программы: python manage.py runserver

Запуск проекта с помощью Docker Compose

Этот проект использует Docker Compose для запуска всех необходимых сервисов одной командой. 

В состав проекта входят:

1.Веб-приложение на Django;

2.PostgreSQL — база данных;

3.Redis — брокер сообщений для Celery;

4.Celery Worker — для выполнения фоновых задач;

5.Celery Beat — для планирования периодических задач.

##Подготовка к запуску проекта:

1.Установите Docker.

2.Установите Docker Compose.

3.Убедитесь, что Docker запущен и работает.

4.Запустите Redis-server.exe

##Запуск проекта:
1.Клонируйте репозиторий: https://github.com/Ivan-S-estnov/viewset_and_generic.git

2.Создайте файл .env в корне проекта и добавьте туда необходимые переменные окружения, указанные в файле .env.sample.

3.Запустите проект, выполнив команду для запуска в фоновом режиме: docker-compose up -d

После запуска веб-приложение будет доступно по адресу: http://localhost:8000

##Сервер 158.160.16.234

##Настройка сервера (работаем через терминал)

1.Запускаем сервер: ssh SSH_USER@IP_SERVER

2.Обновляем системы:

sudo apt update
sudo apt upgrade

3.Установка Docker compose по документации: https://docs.docker.com/engine/install/ubuntu/#install-using-the-repository

4.Активируем файрвол: status ufw enable

5.Открываем порты:

sudo ufw allow 80/tcp

sudo ufw allow 443/tcp

sudo ufw allow 22/tcp

##Настройка CI/CD

Устанавливаем линтер: pip install flake8

Настройка линтера: Создаем файл ci.yml в директории .github/workflows/ вашего репозитория. Добавляем job для запуска Flake8, чтобы проверять код на соответствие стандартам PEP8. Линтер должен запускаться при каждом коммите и pull request.

Настройка тестов: Добавляем в job в workflow, которая будет устанавливать зависимости, применять миграции и запускать тесты Django-приложения. Тесты должны быть блокирующими: если они не проходят, дальнейший деплой не выполняется.

Сборка и публикация Docker-образов: Добавляем шаги для сборки Docker-образа приложения в workflow. Настраеваем публикацию образа в Docker Hub. Используем GitHub Secrets для хранения учетных данных Docker Hub (логин и токен доступа).

Настройка автоматического деплоя на сервер: Настраеваем деплой Docker-образа на сервер. Включаем шаги для остановки старого контейнера и запуска нового с обновленным образом. Деплой выполняется только в том случае, если все предыдущие этапы (линтеры, тесты) прошли успешно.

Проверка работы пайплайна: Делаем коммит в свой репозиторий и следим за выполнением всех шагов пайплайна в GitHub Actions. Пайплайн должен успешно выполнять все шаги, включая линтинг, тестирование, сборку Docker-образа, публикацию и деплой. Если какой-либо из шагов не прошел, исправляем ошибки и снова запускаем пайплайн. Когда пайплайн выполнится успешно, убедимся, что приложение работает на сервере, как ожидалось.

##Дополнительные команды:

1.Для просмотра запущенных контейнеров: docker-compose ps

2.Для просмотра логов всех контейнеров: docker-compose logs

3.Для остановки сервисов и удаления контейнеров: docker-compose down